<div class="container-fluid">
  <div class="d-sm-flex align-items-center justify-content-between mb-4">
    <h1 class="h3 mb-0 text-gray-800"><%= title %></h1>
    <div>
      <a href="/nugecid" class="btn btn-secondary btn-sm btn-icon-split me-2">
        <span class="icon text-white-50"><i class="fas fa-arrow-left"></i></span>
        <span class="text">Voltar</span>
      </a>
      <button onclick="printDocument()" class="btn btn-info btn-sm btn-icon-split me-2">
        <span class="icon text-white-50"><i class="fas fa-print"></i></span>
        <span class="text">Imprimir</span>
      </button>
      <form action="/nugecid/termo/baixar-docx" method="POST" class="d-inline">
        <input type="hidden" name="_csrf" value="<%= csrfToken %>">
        <button type="submit" class="btn btn-success btn-sm btn-icon-split">
          <span class="icon text-white-50"><i class="fas fa-file-word"></i></span>
          <span class="text">Salvar como DOCX</span>
        </button>
      </form>
    </div>
  </div>

  <div class="card shadow mb-4">
    <div class="card-body">
      <div id="documento-preview" style="background: white; padding: 40px; border: 1px solid #ddd; border-radius: 5px;">
        <%- htmlContent %>
      </div>
    </div>
  </div>
</div>

<script>
  function printDocument() {
    const content = document.getElementById('documento-preview').innerHTML;
    const printWindow = window.open('', '_blank');
    printWindow.document.write(`
      <html>
        <head>
          <title>Termo de Desarquivamento</title>
          <style>
            body { 
              font-family: Arial, sans-serif; 
              margin: 20px; 
              line-height: 1.6;
            }
            table { 
              border-collapse: collapse; 
              width: 100%; 
              margin: 20px 0;
            }
            th, td { 
              border: 1px solid #ddd; 
              padding: 8px; 
              text-align: left; 
            }
            th { 
              background-color: #f2f2f2; 
            }
            h2 {
              text-align: center;
              margin-bottom: 30px;
              font-size: 18px;
              text-transform: uppercase;
            }
            @media print {
              body { margin: 0; }
              @page { margin: 2cm; }
            }
          </style>
        </head>
        <body>
          ${content}
        </body>
      </html>
    `);
    printWindow.document.close();
    printWindow.print();
  }
</script>

<style>
  .document-preview {
    background-color: #fff;
    padding: 2rem;
    border: 1px solid #e3e6f0;
    box-shadow: 0 0.15rem 1.75rem 0 rgba(58, 59, 69, 0.15);
    max-width: 8.5in; /* Largura de uma p√°gina A4 */
    margin: auto;
  }
  @media print {
    body * {
      visibility: hidden;
    }
    #editor, #editor * {
      visibility: visible;
    }
    #editor {
      position: absolute;
      left: 0;
      top: 0;
      width: 100%;
      border: none;
      box-shadow: none;
      padding: 0;
    }
  }
</style>
